sudo: false
language: python
services:
  - postgresql

cache: pip

env:
  global:
    - SECRET_KEY=topsecret123
    - EMAIL_FROM_NAME="John Doe"
    - EMAIL_FROM_ADDRESS="john.doe@example.org"
    - EMAIL_AUTH_NAME="messaging"
    - EMAIL_AUTH_PASS="messaging"
    - TUNNISTAMO_URL='http://localhost/'

python:
  - "3.5"
  - "3.6"
  - "nightly"

install:
  - pip install -U pip
  - pip install -r requirements.txt -r requirements-dev.txt

before_script:
  - psql -U postgres -c 'create database aggregaatori;'
  - psql -U postgres -c "create extension postgis;"

script:
  - flake8
  - pytest -ra -vvv --cov=.
  - isort -c

after_success: codecov
